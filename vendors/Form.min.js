(function(k){if(void 0===k.jQuery)throw"jQuery library required";var f=k.jQuery,h=f("form"),n={convert:function(a){return a.constructor===Date?a:a.constructor===Array?new Date(a[0],a[1],a[2]):a.constructor===Number?new Date(a):a.constructor===String?new Date(a):"object"===typeof a?new Date(a.year,a.month,a.date):NaN},compare:function(a,b){return isFinite(a=this.convert(a).valueOf())&&isFinite(b=this.convert(b).valueOf())?(a>b)-(a<b):NaN},inRange:function(a,b,d){return isFinite(a=this.convert(a).valueOf())&&
isFinite(b=this.convert(b).valueOf())&&isFinite(d=this.convert(d).valueOf())?b<=a&&a<=d:NaN}},e=function(a,b){var d=a[0].tagName,g=a.closest(".form-group"),e,c=f(".form-control,[data-form-role=element],.note-editor",g);"INPUT"===d&&-1!==f.inArray(a.attr("type"),["text","number","email","phone","url"])||"TEXTAREA"===d?a.focus():"SELECT"===d&&a.prev(".select2-container").select2("open");g.removeClass("has-success").addClass("has-error");f(".help-block",g).html(b);g.hasClass("has-feedback")&&(f(".form-control-feedback",
    g).remove(),e=f('<span class="glyphicon glyphicon-warning-sign form-control-feedback"/>'),e.appendTo(g));c.bind("keydown click",function(){g.removeClass("has-error");f(".help-block",g).html(a.data("helper"));g.hasClass("has-feedback")&&e.remove();c.unbind("keydown click")})},p=function(){var a=!0;f("[data-form-role=element]",h).each(function(){var b=f(this),d=k.FormElementGetDataFns[b.attr("id")](),g=b.data("rules"),h,c;if(g)for(h=0;h<g.length;h++)switch(c=g[h],c.rule){case "required":a=""!==d;if(!a)return e(b,
    c.errMsg),!1;break;case "email":a=/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(d);
    if(!a)return e(b,c.errMsg),!1;break;case "url":a=RegExp("^(http|https):\\/\\/(([a-zA-Z0-9$\\-_.+!*'(),;:&=]|%[0-9a-fA-F]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Z0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Z]{2,}))(:[0-9]+)?(\\/(([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*(\\/([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*)*)?(\\?([a-zA-Z0-9$\\-_.+!*'(),;:@&=/?]|%[0-9a-fA-F]{2})*)?(\\#([a-zA-Z0-9$\\-_.+!*'(),;:@&=/?]|%[0-9a-fA-F]{2})*)?)?$").test(d);
    if(!a)return e(b,c.errMsg),!1;break;case "number":a=d&&!isNaN(d);if(!a)return e(b,c.errMsg),!1;break;case "regexp":a=(new RegExp(c.optVal)).test(d);if(!a)return e(b,c.errMsg),!1;break;case "minNum":var m=c.optVal,l=d;a=l&&!isNaN(l)&&l>=m;if(!a)return e(b,c.errMsg),!1;break;case "maxNum":m=c.optVal;a=(l=d)&&!isNaN(l)&&l<=m;if(!a)return e(b,c.errMsg),!1;break;case "minLen":a=d.length>=c.optVal;if(!a)return e(b,c.errMsg),!1;break;case "maxLen":a=d.length<=c.optVal;if(!a)return e(b,c.errMsg),!1;break;
    case "include":a=-1!==d.indexOf(c.optVal);if(!a)return e(b,c.errMsg),!1;break;case "exclude":a=-1===d.indexOf(c.optVal);if(!a)return e(b,c.errMsg),!1;break;case "range":a=-1!==f.inArray(d,c.optVal);if(!a)return e(b,c.errMsg),!1;break;case "unrange":a=-1===f.inArray(d,c.optVal);if(!a)return e(b,c.errMsg),!1;break;case "begin":a=-1<n.compare(d,c.optVal);if(!a)return e(b,c.errMsg),!1;break;case "end":if(a=1>n.compare(d,c.optVal),!a)return e(b,c.errMsg),!1}});return a};f.showFormError=e;h.bind("submit",
    function(a){a.preventDefault();if(p()){var b=f("[type=submit]",h);b.button("loading");if("direct"===h.attr("submitType"))h[0].submit();else{a={};for(var d in k.FormElementGetDataFns)if("undefined"!=d){var e=f("#"+d).attr("name");if(void 0===e){console.log(d+"   undefined");return}"[]"===e.substr(-2)?("undefined"===typeof a[e]&&(a[e]=[]),a[e].push(k.FormElementGetDataFns[d]())):a[e]=k.FormElementGetDataFns[d]()}f("[name=formData]");k.http.timeout=30;k.http.post(h.attr("action"),a,function(a){b.button("reset");
        "successCallback"},function(a){b.button("reset")});return!1}}})})(window);
